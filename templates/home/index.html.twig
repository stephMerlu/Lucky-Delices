{% extends 'base.html.twig' %}

{% block title %}Hello HomeController!{% endblock %}

{% block body %}
<svg class="background--custom" id="demo" viewBox="0 0 100 100" preserveAspectRatio="none">
  <path fill="#A5DB68" fill-opacity="0.7" d="M-100 -100L200 -100L200 50L-100 50Z" style="animation: path0 5s linear infinite alternate;" /><path fill="#F8DA3A" fill-opacity="0.7" d="M-100 -100L200 -100L200 50L-100 50Z" style="animation: path1 12.5s linear infinite alternate;" /><path fill="#FFFFFF" fill-opacity="0.2" d="M-100 -100L200 -100L200 20L-100 20Z" style="animation: path2 30s linear infinite alternate;" />
</svg>
{% if app.session.flashBag.has('success') %}
    <div class="alert alert-success">{{ app.session.flashBag.get('success')[0] }}</div>
{% endif %}
<section class="presentation">
  <div class="row">
    <div class="col-sm-6">
      <img class="crepe" src="/images/20220330_185609.jpg" alt="">
    </div>
    <div class="col-sm-6">
      <div class="text">
        <h1 class="display-4">Lucky Délices</h1>
        <h2 class="subscribe1">La crème, de la crème.</h2>
        <h3 class="subscribe2">Venez découvrir sans plus tarder, mes délicieuses recettes...</h3>
      </div>
    </div>
  </div>
</section>
<section class="news">
  <h1>Mes dernières recettes</h1>
  <div class="cards">
    {% for recipe in recipes %}
      <div class="card">
        <a href="{{ path('app_presentation_recette', {id: recipe.id}) }}">
          <div class="card-image">
            <img src="{{ vich_uploader_asset(recipe, 'imageFile') }}" />
          </div>
          <div class="card-body">
            <div class="card-title">
              <h2>{{ recipe.name }}</h2>
            </div>
            <div class="card-excerpt">
              <span class="info">{{ recipe.subtitle }}</span>
            </div>
          </div>
        </a>
      </div>
    {% endfor %}
  </div>
</section>


</section>
    <section class="video">
          <h2 class="title">Ma sélection du mois </h2>
    <div class="video-responsive">
        <iframe src="https://www.youtube.com/embed/e7LmBozXsH8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
    </section>
<section class="favorites">
  <h1>Vos recettes favorites</h1>
  <div class="cards">
    {% for recipe in favoriteRecipes %}
      <div class="card">
        <a href="{{ path('app_presentation_recette', {id: recipe.id}) }}">
          <div class="card-image">
            <img src="{{ vich_uploader_asset(recipe, 'imageFile') }}" />
          </div>
          <div class="card-body">
            <div class="card-title">
              <h2>{{ recipe.name }}</h2>
            </div>
            <div class="card-excerpt">
              <span class="info">{{ recipe.subtitle }}</span>
            </div>
          </div>
        </a>
      </div>
    {% endfor %}
  </div>
</section>




<script>
  function fetchData(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
      if (xhr.readyState === 4 && xhr.status === 200) {
        callback(JSON.parse(xhr.responseText));
      }
    };
    xhr.open('GET', url, true);
    xhr.send();
  }

  function displayRecipes(recipes) {
    var cardsContainer = document.querySelector('.cards');

    recipes.forEach(function(recipe) {
      var card = document.createElement('div');
      card.classList.add('card');

      var link = document.createElement('a');
      link.href = '/path/to/recipe/' + recipe.id;

      var image = document.createElement('div');
      image.classList.add('card-image');
      image.style.backgroundImage = 'url(' + vich_uploader_asset(recipe, 'imageFile') + ')';
      link.appendChild(image);

      var body = document.createElement('div');
      body.classList.add('card-body');

      var title = document.createElement('div');
      title.classList.add('card-title');
      var titleText = document.createElement('h2');
      titleText.textContent = recipe.name;
      title.appendChild(titleText);

      var excerpt = document.createElement('div');
      excerpt.classList.add('card-excerpt');
      var excerptText = document.createElement('span');
      excerptText.classList.add('info');
      excerptText.textContent = recipe.subtitle;
      excerpt.appendChild(excerptText);

      body.appendChild(title);
      body.appendChild(excerpt);

      link.appendChild(image);
      link.appendChild(body);

      card.appendChild(link);

      cardsContainer.appendChild(card);
    });
  }

  fetchData('/recipes/recent', function(data){
    var recentRecipes = data.slice(0, 3);
    displayRecipes(recentRecipes);
  });

</script>
{% endblock %}